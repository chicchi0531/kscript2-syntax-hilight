{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "kscript2",
    "patterns": [
        {
            "include": "#comments"
        },
		{
			"include": "#novels"
		},
		{
            "include": "#strings"
        },
        {
            "include": "#keywords"
        },
        {
            "include": "#vars"
		}
    ],
    "repository": {
        "comments": {
            "patterns": [
                {
                    "comment": "一行コメントは;で始まります",
                    "name": "comment.line",
                    "match": "//.*"
                },
                {
                    "comment": "複数行コメントは{}です",
                    "name": "comment.block",
                    "begin": "/\\*",
                    "end": "\\*/"
                }
            ]
		},
		"novels":{
			"patterns": [
				{
					"comment": "ノベル文",
					"name":"markup.raw",
					"begin": "@{",
					"end": "@}",
					"patterns": [
						{
							"include": "#inline_var"
						},
						{
							"comment": "名前行",
							"name": "markup.bold",
							"match": "\\-.*",
							"patterns": [
								{
									"include": "#inline_var"
								}
							]
						},
                        {
                            "comment": "命令行",
                            "name": "entity.name.function",
                            "match": "\\b(BG|ST|CLR|SE|BGM|EV|CLR_EV)\\b.*"
                        },
                        {
                            "comment": "埋め込み命令",
                            "name": "markup.inline.raw",
                            "begin": "<[^pn/]*>",
                            "end": "</.*>"
                        },
						{
							"comment": "改行文字",
							"name": "keyword.other",
							"match": "」|<p>|<n>"
						}
					]
				}
			]
		},
        "strings": {
            "comment": "文字列です",
            "name": "string.quoted",
            "begin": "\"",
            "end": "\""
        },
        "keywords": {
            "patterns": [
                {
                    "name": "keyword.control",
                    "match": "\\b(if|else|for|while|break|continue|return|import|system)\\b"
                },
                {
                    "name": "keyword",
                    "match": "\\b(int|float|string|void|null)\\b"
				},
				{
					"name":"keyword.operator",
					"match": "\\+|\\-|\\*|/|\\%|<|>|(\\!=)|=|(\\&\\&)|(\\|\\|)"
				}
            ]
        },
        "vars": {
            "patterns": [
                {
                    "comment": "数字です",
                    "name": "constant.numeric",
                    "match": "%[\\-0-9]+"
                },
                {
                    "comment": "変数です",
                    "name": "variable",
                    "match": "[a-zA-Z_][0-9a-zA-Z_\\[\\]]*"
                }
            ]
		},
		"inline_var":{
			"patterns": [
				{
					"comment": "組み込み変数",
					"name": "variable",
					"match": "\\%[a-zA-Z_][a-zA-Z_0-9]*\\%"
				}
			]
		}
    },
    "scopeName": "source.ks2"
}